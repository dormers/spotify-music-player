# Spotify Music Player 프로젝트

이 프로젝트는 Node.js와 Express를 기반으로 한 Spotify 음악 플레이어입니다. 사용자는 회원가입 및 로그인을 통해 서비스를 이용할 수 있으며, Spotify 계정을 연동하여 음악을 검색하고 재생할 수 있습니다.

## 목차

1. [프로젝트 소개](#1-프로젝트-소개)
2. [기능 소개](#2-기능-소개)
3. [시작하기](#3-시작하기)
   - [필수 조건](#필수-조건)
   - [설치](#설치)
   - [환경 변수 설정](#환경-변수-설정)
   - [데이터베이스 설정](#데이터베이스-설정)
   - [SSL 인증서 생성](#ssl-인증서-생성)
   - [Spotify 개발자 설정](#spotify-개발자-설정)
4. [스크립트 및 명령어](#4-스크립트-및-명령어)
5. [폴더 구조](#5-폴더-구조)
6. [주요 파일 설명](#6-주요-파일-설명)
7. [기여 방법](#7-기여-방법)

---

## 1. 프로젝트 소개

이 프로젝트는 Spotify API와 Web Playback SDK를 활용하여 사용자에게 음악 검색 및 재생 기능을 제공합니다. Oracle 데이터베이스를 사용하여 사용자 정보를 관리하며, 사용자 인증 및 세션 관리를 구현하였습니다.

---

## 2. 기능 소개

- **회원가입 및 로그인**: 사용자는 아이디와 비밀번호를 통해 회원가입 및 로그인을 할 수 있습니다.
- **Spotify 계정 연동**: 로그인한 사용자는 자신의 Spotify 계정을 연동하여 음악 서비스를 이용할 수 있습니다.
- **음악 검색 및 재생**: Spotify의 방대한 음악 라이브러리에서 원하는 곡을 검색하고 재생할 수 있습니다.
- **페이지네이션**: 검색 결과에 페이지네이션을 적용하여 많은 곡을 효율적으로 탐색할 수 있습니다.

---

## 3. 시작하기

### 필수 조건

- Node.js (v14 이상 권장)
- npm (Node.js 설치 시 자동 포함)
- Oracle Database Express Edition (XE) 또는 Oracle 데이터베이스 인스턴스
- Oracle Instant Client 및 `oracledb` Node.js 모듈 설치
- Spotify 개발자 계정
- OpenSSL (SSL 인증서 생성용)

### 설치

1. **프로젝트 클론**

   ```bash
   git clone https://github.com/dormers/spotify-music-player.git
   cd spotify-music-player
   ```

2. **패키지 설치**

   ```bash
   npm install
   ```

### 환경 변수 설정

- 환경 변수를 사용하기 위해 dotenv 패키지를 설치하겠습니다.
   ```bash
   npm install dotenv
   ```

- 프로젝트 루트에 `.env` 파일을 생성하고 다음 내용을 추가합니다.

  ```env
  SESSION_SECRET=your-session-secret
  DB_USER=your-db-username
  DB_PASSWORD=your-db-password
  CLIENT_ID=your-spotify-client-id
  CLIENT_SECRET=your-spotify-client-secret
  REDIRECT_URI=https://localhost:5500/callback
  ```

- 각 값들을 실제 환경에 맞게 변경하세요.

### 데이터베이스 설정

1. **Oracle Instant Client 설치**

   - Oracle Instant Client를 [다운로드](https://www.oracle.com/database/technologies/instant-client.html)하고 설치합니다.
   - 설치 후 환경 변수 `LD_LIBRARY_PATH` (Linux/Mac) 또는 `PATH` (Windows)에 Instant Client의 경로를 추가합니다.

2. **데이터베이스 테이블 생성**

   - Oracle SQL*Plus 또는 SQL Developer를 사용하여 다음 테이블을 생성합니다.

     ```sql
     CREATE TABLE user_info (
       user_id VARCHAR2(100) PRIMARY KEY,
       user_password VARCHAR2(100) NOT NULL,
       user_nickname VARCHAR2(100),
       user_access INT DEFAULT 0,
       access_id NUMBER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
       user_spotify_email VARCHAR2(100) UNIQUE,
       user_spotify_image_url VARCHAR2(255),
       user_spotify_url VARCHAR2(255),
       user_spotify_country VARCHAR2(50),
       user_spotify_access_token VARCHAR2(255),
       user_spotify_refresh_token VARCHAR2(255)
     );
     ```

### SSL 인증서 생성

1. **SSL 디렉토리 생성**

   ```bash
   mkdir ssl
   cd ssl
   ```

2. **SSL 인증서 및 키 생성**

   - [링크](https://slproweb.com/products/Win32OpenSSL.html)에서 Standard 버전 설치(Ligth 버전 제외)
   - 설치 시 "The OpenSSL binaries (/bin) directory should be in the Windows system directory" 옵션을 선택하여 PATH에 추가
   - 설치 후에도 ssl 키 생성되지 않을 경우 git bash로 프로젝트 루트 열어서 생성합니다.
   
   ```bash
   openssl genrsa -out server.key 2048
   openssl req -new -key server.key -out server.csr
   openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
   ```

   - 프롬프트에 따라 정보 입력 (테스트용이므로 임의의 값 입력 가능)

4. **프로젝트 루트로 이동**

   ```bash
   cd ..
   ```

### Spotify 개발자 설정

1. **Spotify 개발자 계정 생성**

   - [Spotify for Developers](https://developer.spotify.com/)에 접속하여 개발자 계정을 생성합니다.

2. **앱 생성**

   - 대시보드에서 새로운 앱을 생성하고 `CLIENT_ID`와 `CLIENT_SECRET`을 확인합니다.

3. **Redirect URI 등록**

   - 앱 설정에서 Redirect URI에 `https://localhost:5500/callback`을 추가합니다.

---

## 4. 스크립트 및 명령어

- **서버 실행**

  ```bash
  node server.js
  ```

- 서버는 `https://localhost:5500/`에서 실행됩니다.

---

## 5. 폴더 구조

```
spotify-music-player/
├── server.js
├── package.json
├── package-lock.json
├── .env
├── ssl/
│   ├── server.crt
│   └── server.key
├── public/
│   ├── index.html
│   ├── login.html
│   ├── register.html
│   ├── styles.css
│   ├── script.js
│   ├── login.js
│   └── register.js
```

---

## 6. 주요 파일 설명

- **server.js**: 메인 서버 파일로, Express 서버와 API 엔드포인트를 정의합니다.
- **public/**: 정적 파일을 보관하는 디렉토리로, 클라이언트 측 HTML, CSS, JavaScript 파일들이 포함됩니다.
  - **index.html**: 메인 페이지로, 음악 검색 및 재생 기능을 제공합니다.
  - **login.html**, **register.html**: 로그인 및 회원가입 페이지입니다.
  - **styles.css**: 스타일시트 파일로, 전체적인 스타일을 정의합니다.
  - **script.js**: 메인 페이지의 클라이언트 측 JavaScript 로직을 담고 있습니다.
  - **login.js**, **register.js**: 로그인 및 회원가입 페이지의 JavaScript 로직입니다.
- **ssl/**: SSL 인증서와 키를 보관하는 디렉토리입니다.
  - **server.crt**, **server.key**: SSL 인증서와 키 파일입니다.

---

## 7. 기여 방법

1. **이슈 생성**: 버그 신고나 기능 제안은 GitHub의 Issue 탭을 통해 제출해 주세요.
2. **포크 및 PR**: 프로젝트를 포크하고 수정 사항을 커밋한 후 Pull Request를 제출해 주세요.
3. **코딩 규칙 준수**: 기존 코드 스타일과 일관성을 유지해 주세요.

---

## 문의

프로젝트 관련 문의사항은 [이메일 주소]를 통해 연락해 주세요.

감사합니다!
